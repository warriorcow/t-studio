---
import Container from "./UI/Container.astro";
import Title from "./UI/Title.astro";

const tabs = [
  {
    tab: 'Внешний интерфейс',
    tags: [
      'JavaScript', 'React.js', 'Vue.js', 'Angular.js', 'Svelte.js', 'Ember.js'
    ]
  },
  {
    tab: 'Бэкенд',
    tags: [
      'PHP', 'Laravel', 'Go', 'Java'
    ]
  },
  {
    tab: 'Фреймворки',
    tags: [
      'React.js', 'Vue.js', 'Angular.js'
    ]
  },
  {
    tab: 'Мобильный',
    tags: [
      'Swift', 'Dart'
    ]
  },
  {
    tab: 'Софтверный',
    tags: [
      'C++', 'C#'
    ]
  }
]
---

<Container>
  <div class="skills">
    <Title
        tag="h2"
        text="Какие технологии используем"
        color="lightblue"
        isBlock
        hasArrow
    />

    <div class="skills__tabs">
      <div class="skills__tabs-header">
        {
          tabs.map(tab =>
              <div class="skills__tabs-tab">
                {tab.tab}
              </div>
          )
        }
      </div>
      <div class="skills__tabs-contents">
        {
          tabs.map(tab =>
              <div class="skills__tabs-content">
                {
                  tab.tags.map(tag =>
                      <div class="skills__tag">
                        {tag}
                      </div>
                  )
                }
              </div>
          )
        }
      </div>
    </div>
  </div>
</Container>

<style lang="scss" is:global>
  .skills {
    color: $secondary;
    border-radius: 20px;
    background-image: url('../assets/skills-bg.png');
    background-size: cover;
    padding: 60px 0;
    overflow: hidden;

    @include media(md) {
      padding: 50px 10px;
      margin: 0 -10px;
      border-radius: 0;
    }

    &__tabs {
      @include MontserratMedium26;

      margin-top: 50px;

      @include media(md) {
        @include MontserratMedium18;
      }

      &-header {
        display: flex;
        flex-wrap: wrap;
        gap: 20px 40px;
        padding-left: 168px;
        padding-right: 20px;

        @include media(md) {
          flex-wrap: nowrap;
          padding: 0 10px;
          margin: 0 -10px;
          gap: 20px;
          overflow-x: auto;
          scrollbar-width: none;
          -ms-overflow-style: none;

          &::-webkit-scrollbar {
            display: none;
          }
        }
      }

      &-tab {
        cursor: pointer;
        position: relative;
        white-space: nowrap;

        &::before {
          position: absolute;
          content: '';
          bottom: 0;
          left: 0;
          width: 100%;
          height: 1px;
          background-color: #6DE8DD;
          transition: transform 300ms ease-in-out;
          transform-origin: left center;
          transform: scaleX(0);
        }

        &.active {
          color: #6DE8DD;

          &::before {
            transform: scaleX(1);
          }
        }
      }

      &-contents {
        display: flex;
        transition: transform 300ms ease-in-out;
        margin-top: 50px;


        @include media(md) {
          margin: 30px -10px 0;
          box-sizing: border-box;
          gap: 10px;
        }
      }

      &-content {
        display: flex;
        align-content: flex-start;
        flex-wrap: wrap;
        gap: 20px;
        flex: 1 0 calc(100%);
        padding-left: 168px;
        padding-right: 20px;

        @include media(md) {
          padding: 0 10px;
          gap: 10px;
          margin-right: -10px;
        }
      }
    }

    &__tag {
      padding: 20px 30px;
      background-color: $secondary;
      color: $primary;
      border-radius: 10px;

      @include media(md) {
        padding: 10px 15px;
      }
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const tabs = document.querySelectorAll(".skills__tabs-tab");
    const contents = document.querySelector(".skills__tabs-contents");

    tabs.forEach((tab, index) => {
      tab.addEventListener("click", () => {
        tabs.forEach(t => t.classList.remove("active"));
        tab.classList.add("active");
        contents.style.transform = `translateX(calc(-100% * ${index}))`;
      });
    });

    // Устанавливаем активный первый таб по умолчанию
    if (tabs.length > 0) {
      tabs[0].classList.add("active");
    }
  });
</script>